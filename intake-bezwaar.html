<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Bezwaar starten | ZekerOpWeg</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="css/styles.css">
</head>

<body class="fade-in">
<section class="container">

<div class="contact-card">
<h2>Bezwaar starten</h2>
<p>Upload uw boete en wij starten automatisch uw juridische dossier.</p>

<form id="bezwaarForm">

<input name="naam" placeholder="Naam" required>
<input name="email" placeholder="E-mail" required>
<input name="kenteken" placeholder="Kenteken" required>
<input name="beschikking" placeholder="Beschikkingsnummer" required>
<input name="type" placeholder="Overtreding (bijv. parkeren)" required>
<input name="token" placeholder="Abonnementscode" required>

<textarea name="toelichting" rows="4" placeholder="Uw toelichting (optioneel)"></textarea>

<input type="file" id="boete" required>

<button class="btn-primary">Bezwaar starten</button>
</form>

<div id="apiResult"></div>
</div>

<script>
document.getElementById("bezwaarForm").addEventListener("submit", async e => {
  e.preventDefault();
  const r = document.getElementById("apiResult");
  r.innerHTML = "â³ Dossier wordt aangemaakt...";

  const f = document.getElementById("boete").files[0];
  const b64 = await new Promise(res=>{
    const reader = new FileReader();
    reader.onload = () => res(reader.result.split(",")[1]);
    reader.readAsDataURL(f);
  });

  const payload = {
    naam: bezwaarForm.naam.value,
    email: bezwaarForm.email.value,
    kenteken: bezwaarForm.kenteken.value,
    beschikking: bezwaarForm.beschikking.value,
    type: bezwaarForm.type.value,
    token: bezwaarForm.token.value,
    toelichting: bezwaarForm.toelichting.value,
    filename: f.name,
    filedata: b64
  };

  const res = await fetch("https://script.google.com/macros/s/AKfycbxsWyk3Sgbwwz8Nm6oNPyK9Bzd8R741uC-KucSieCaU84xxu60JvX183-2i8qyOtQnhyQ/exec", {
    method:"POST",
    body: JSON.stringify(payload)
  });

  r.innerHTML = await res.text();
});
</script>
</section>
</body>
</html>


